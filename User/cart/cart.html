<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FoodHub - Your Cart</title>
    <link rel="stylesheet" href="../style.css" />
    <!-- SweetAlert2 CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" />
  </head>

  <body>
    <!-- Navigation Bar -->
    <nav class="navbar">
      <div class="logo">FoodHub</div>
      <ul class="nav-links">
        <li><a href="../homepage/menu.php">HOME</a></li>
        <li><a href="../checkout/checkout.html">MY ORDERS</a></li>
        <li>CART</li>
      </ul>
      <button class="account-btn" id="accountBtn">LOGIN</button>
    </nav>

    <!-- Cart Content -->
    <div class="cart-container">
      <div class="cart-main">
        <!-- Voucher Section -->
        <div class="voucher-section">
          <div class="voucher-header">
            <h3>Add a Voucher Code</h3>
            <button class="collapse-btn">‚à®</button>
          </div>
          <div class="voucher-input-group">
            <input
              type="text"
              placeholder="Enter Voucher Code"
              class="voucher-input"
              id="voucher-code" />
            <button class="apply-btn" id="apply-voucher-btn">Apply</button>
          </div>
        </div>

        <!-- Order Details -->
        <div class="order-details-section">
          <div class="order-header">
            <h3>Order Details</h3>
            <button class="collapse-btn">‚à®</button>
          </div>

          <!-- Optional promo bundle UI -->
          <div class="deal-card" id="deal-card" style="display: none">
            <div class="deal-info">
              <div class="deal-title" id="deal-title">Voucher</div>
              <div class="deal-price" id="deal-price">$0.00</div>
            </div>
            <div class="deal-description" id="deal-desc">Deal description here</div>
            <button class="remove-deal-btn" id="deal-remove-btn">üóëÔ∏è Remove Deal</button>
          </div>

          <!-- Cart Items (dynamic) -->
          <div class="cart-items" id="cart-items">
            <!-- JS injects cart items here -->
          </div>
        </div>

        <!-- Price Summary -->
        <div class="price-summary">
          <div class="price-row">
            <span class="price-label">Original Price</span>
            <span class="price-value" id="original-price">$0.00</span>
          </div>
          <div class="price-row">
            <span class="price-label">Voucher Discounts</span>
            <span class="price-value discount" id="discount-amount">$0.00</span>
          </div>
          <div class="price-row total">
            <span class="price-label">Order Total</span>
            <span class="price-value" id="order-total">$0.00</span>
          </div>
        </div>

        <!-- Checkout Button -->
        <button class="checkout-btn" id="checkout-btn">
          <span class="checkout-items" id="checkout-items-text">0 items | $0.00</span>
          <span class="checkout-text">Checkout</span>
        </button>
      </div>
    </div>

    <!-- SweetAlert2 JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Cart JS -->
    <script src="cart.js"></script>

    <script>
      // Optional: Voucher Apply Button Logic
      document.getElementById("apply-voucher-btn")?.addEventListener("click", () => {
        const code = document.getElementById("voucher-code")?.value.trim();
        if (!code) {
          Swal.fire({ icon: "error", title: "Empty Code", text: "Please enter a voucher code." });
          return;
        }

        // Example: simple fixed discount for demonstration
        const discountAmount = 5; // $5 off
        document.getElementById("deal-card").style.display = "flex";
        document.getElementById("deal-price").textContent = `$${discountAmount.toFixed(2)}`;
        document.getElementById("deal-desc").textContent = `Voucher "${code}" applied`;

        // Update discount in totals
        const cart = loadCart();
        const subtotal = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
        document.getElementById("discount-amount").textContent = `$${discountAmount.toFixed(2)}`;
        document.getElementById("order-total").textContent = `$${(
          subtotal - discountAmount
        ).toFixed(2)}`;

        Swal.fire({
          icon: "success",
          title: "Voucher Applied",
          text: `Discount of $${discountAmount.toFixed(2)} applied!`,
          toast: true,
          position: "top-end",
          showConfirmButton: false,
          timer: 2000,
        });
      });

      document.getElementById("deal-remove-btn")?.addEventListener("click", () => {
        document.getElementById("deal-card").style.display = "none";
        document.getElementById("discount-amount").textContent = "$0.00";

        // Recalculate total
        const cart = loadCart();
        const subtotal = cart.reduce((sum, item) => sum + item.price * item.qty, 0);
        document.getElementById("order-total").textContent = `$${subtotal.toFixed(2)}`;

        Swal.fire({
          icon: "info",
          title: "Voucher Removed",
          toast: true,
          position: "top-end",
          showConfirmButton: false,
          timer: 2000,
        });
      });
    </script>
  </body>
</html>
